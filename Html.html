<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QueryModal</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.15/dist/tailwind.min.css" rel="stylesheet">
    <style>
        body {
            background: #0b0bba no-repeat;
            background-attachment: fixed;
            background-size: cover;
        }

        .icons {
            font-size: 30px;
        }

        .box {
            width: 91vw;
        }

        .pritext {
            color: #0b0bba;
        }

        .sectext {
            color: #0b0bba;
        }

        .tertext {
            color: #0b0bba;
        }

        .pricor {
            background-color: #0b0bba;
        }

        .seccor {
            background-color: #0b0bba;
        }

        .tercor {
            background-color: #0b0bba;
        }

        .selected {
            background-color: #0b0bba;
        }

        .prebox {
            color: #0b0bba;
            border-radius: 10px;
            max-height: 400px;
        }

        .json-string {
            color: #8b4f01;
        }

        .json-number {
            color: #00ff00;
        }

        .json-boolean {
            color: #0b0bba;
        }

        .json-key {
            color: blue;
        }

        .json-null {
            color: #8B0000;
        }
    </style>
</head>

<body>
    <div class="overflow-hidden border-t-4 rounded-md border-blue-500">
        <div class="header bg-black text-white flex items-center rounded-t-md p-1">
            <h2 class="m-0 text-bold textpri text-lg">Title</h2>
            <p class="m-0 textter text-sm ml-4">
                <input type='text' placeholder='Pesquisar...' value="" id='searchInput'
                    class='block p-2 w-full text-sm text-white corsec border duration-200 border-none rounded focus:border-blue-500' />
            </p>
            <p class="m-0 textter text-sm ml-4 hidden md:block">Description</p>
            <button class="ml-auto px-4 py-2 corsec text-white rounded" onclick="handleButtonClick()">
                Button
            </button>
        </div>
        <div class="overflow-auto rounded-b-md bg-gray-800 p-2">
            <div id="queryedCode"></div>
        </div>
    </div>

    <script>hljs.highlightAll();</script>
    <script>
        function QueryModal({
            id = "queryedCode",
            data,
            search,
            children,
            setedPage,
            limit = 10
        }) {
            // Estados para gerenciar o estado da query, a página atual, a ativação do filtro,
            // a lista de resultados filtrados e os dados originais.
            let query = [];
            let currentPage = setedPage ? setedPage : 1;
            let activefilter = false;
            let queryed = [];
            const resultsPerPage = limit;

            // Efeito colateral para atualizar a query com base nos dados, termo de pesquisa e página atual.
            if (data) {
                const filteredData = data.filter(item =>
                    JSON.stringify(item).toLowerCase().includes(search.toLowerCase())
                );
                if (queryed.length === data.length && activefilter) currentPage = 1;
                activefilter = search !== "" && filteredData.length > 0;
                queryed = filteredData;
                const startIndex = (currentPage - 1) * resultsPerPage;
                const endIndex = startIndex + resultsPerPage;
                query = filteredData.slice(startIndex, endIndex);
            }

            // Cálculo do número total de páginas com base nos resultados por página e na lista filtrada.
            const totalPages = !activefilter
                ? Math.ceil(data.length / resultsPerPage)
                : Math.ceil(queryed.length / resultsPerPage);

            const appContainer = document.getElementById(id);

            // Renderizar children
            const childrenNode = children({ query });

            // Renderizar controles de navegação da página, exibidos apenas se houver mais de uma página.
            let pageControls = "";
            if (totalPages !== 1 && totalPages !== 0) {
                pageControls = `
            <ul class='flex-1 list-style-none flex p-2 items-center justify-center'>
              ${totalPages !== 1 && currentPage !== 1 ? `
                <button
                  onclick="setPage(-1)"
                  ${currentPage === 1 ? "disabled" : ""}
                  class='relative block rounded-full bg-transparent px-3 py-1.5 text-sm text-neutral-600 transition-all duration-300 hover:bg-neutral-100 dark:text-white dark:hover:bg-neutral-700 dark:hover:text-white'
                >
                  Anterior
                </button>` : ""}
              ${queryed.length !== data.length ? `
                <span class='relative block rounded-full bg-transparent px-3 py-1.5 text-sm text-white transition-all duration-300'>
                  ${queryed.length} resultados encontrados, Página ${currentPage} de ${totalPages}
                </span>` : `
                <span class='relative block rounded-full bg-transparent px-3 py-1.5 text-sm text-white transition-all duration-300'>
                  Página ${currentPage} de ${totalPages}
                </span>`}
              ${totalPages > currentPage ? `
                <button
                  onclick="setPage(1)"
                  ${currentPage === totalPages ? "disabled" : ""}
                  class='relative block rounded-full bg-transparent px-3 py-1.5 text-sm text-neutral-600 transition-all duration-300 hover:bg-neutral-100 dark:text-white dark:hover:bg-neutral-700 dark:hover:text-white'
                >
                  Próxima
                </button>` : ""}
            </ul>`;
            }

            // Montar o conteúdo na div "app"
            appContainer.innerHTML = renderContent(childrenNode, pageControls);

            return { currentPage, totalPages };
        }

        function renderContent(childrenNode, pageControls) {
            return `${childrenNode}${pageControls}`;
        }

        document.getElementById('searchInput').addEventListener('input', function (event) {
            const search = event.target.value;
            setSearch(search);
        });

        function setPage(page) {
            const data = QueryModal({
                data: [{"id":1,"username":"admin","email":"admin@gmail.com","lang":"pt-BR","permissions":10000,"remember":"8ce1ed01-0216-4760-bce7-8e15bed4098b","suspended":null,"suspendedReason":null},{"id":2,"username":"admins","email":"admins@gmail.com","lang":"pt-BR","permissions":10000,"remember":null,"suspended":true,"suspendedReason":"Nome impróprio."}],
                search: document.getElementById('searchInput').value,
                setedPage: page ? currentPage + page : undefined,
                children: ({ query }) => {
                    // Função de renderização do conteúdo
                    // Substitua isso com seu próprio código HTML/JS
                    return `    <div class=" bg-gray-400 text-sm"><pre>${JSON.stringify(query, null, 1)}</pre></div>`;
                },
                limit: 5
            });

            currentPage = data.currentPage;
            totalPages = data.totalPages;
        }

        function setSearch(search) {
            setPage(0);
        }

        function handleButtonClick() {
            // Lógica do clique no botão
            console.log('Button clicked');
        }
        document.addEventListener('DOMContentLoaded', setPage(0));
    </script>

</body>

</html>